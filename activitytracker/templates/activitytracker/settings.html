{% extends "base.html" %}
{% load staticfiles %}
{% load custom_templates %}
{% block title %}Settings{% endblock %}
{% block css %}
    <link href="{% static 'activitytracker/css/slider.css' %}" rel="stylesheet">
    <link href="{% static 'bower_components/datatables/media/css/dataTables.bootstrap.min.css' %}" rel="stylesheet">
    <link href="https://cdn.datatables.net/responsive/1.0.7/css/responsive.bootstrap.css" rel="stylesheet">
    <link href="{% static 'bower_components/bootstrap-tokenfield/dist/css/bootstrap-tokenfield.min.css' %}" rel="stylesheet">

{% endblock %}


{% block content %}

   <!-- Content begins HERE ------------------------------------------------------------------>
    <div class="row">
        <div class="col-sm-10 col-sm-offset-1 dashboardWrapper padding-3">
            <div class="box-header" data-original-title>
                <h2 class="padding-4"><i class="fa fa-cloud white margin-right-2"></i><span class="break"></span>Available Providers</h2>
            </div>
            <div class="box-content row">
                <table id=ProvidersTable" class="col-xs-12 text-center user-providers">
                    <tbody>
                        {% for provider_name,provider_data in providerDomValues.items %}
                        <tr class="connected-app {{ provider_name }}">
                            <td ><img src="{% static 'activitytracker/img/'|add:provider_name|add:'.png' %}"/></td>
                            <td><span class="connected-app-text provider-name">{{ provider_name|capitalizeFirstLetter|removeDashes }}</span></td>
                            <td><span class="connected-app-text" style="color:{{ provider_data.statusFontColor }}"><i class='{{ provider_data.statusIcon }}'></i>&nbsp;{{ provider_data.statusText }}</span></td>
                            <td>
                                {% if provider_data.statusText == "App connected" %}
                                <a class="btn connected-app-button btn-blueNavy" onclick="synchronizeProvider('{{ provider_name }}')" title="Synchronize">
                                    <i class="halflings-icon refresh white" title="Synchronize"></i>
                                    &#x21bb;
                                </a>
                                {% endif %}
                                <a onclick="appFunctionHandler('{{ provider_name }}', this)" class="btn connected-app-button btn-blueNavy" title="{{ provider_data.buttonText }}">
                                    <i class="halflings-icon {{ provider_data.buttonIcon }} white" title="{{ provider_data.buttonText }}"></i>
                                    &#10095;
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="row">
                <div class="col-sm-4 col-sm-offset-4 col-xs-12 vertical-margin text-center alert-success hidden" id="success-msg"></div>
            </div>
        </div>
        <div class="col-sm-10 col-sm-offset-1 dashboardWrapper padding-3" id="section-email-notifications">
            <div class="box-header" data-original-title>
                <h2 class="padding-4"><i class="fa fa-envelope white margin-right-2"></i><span class="break"></span>Email notifications</h2>
            </div>
            <div class="box-content padding-horizontal-4">
                <p>Receiving email notifications is an easy way to keep in touch with your favourite projects, as well as to let CloudTeams match you with new, exiting projects we believe you will love!</p>
                <p>You can turn on or off email notifications:</p>
                <div>
                    {% csrf_token %}
                    <select id="email-notifications-settings">
                        <option value="enabled"{% if request.user.profile.email_notifications %} selected="selected"{% endif %}>Enabled</option>
                        <option value="disabled"{% if not request.user.profile.email_notifications %} selected="selected"{% endif %}>Disabled</option>
                    </select>
                    <div class="message padding-vertical-2"></div>
                </div>
            </div>
        </div>
        <div class="col-sm-10 col-sm-offset-1 dashboardWrapper padding-3">
            <div class="box-header" data-original-title>
                <h2 class="padding-4"><i class="fa fa-exclamation-triangle white margin-right-2"></i><span class="break"></span>Danger Zone</h2>
            </div>
            <div class="box-content padding-horizontal-4">
                <p>If you delete your CloudTeams account, all of your data such as profile information, project preferences
                and external activities will be deleted. This action is irreversible.</p>
                <p><a href="#" data-toggle="modal" data-id="delete-account-popup" class="btn btn-sm btn-default">Delete</a></p>
            </div>
        </div>
    </div>

    <div class="modal modal-default hide" id="delete-account-popup">
        <div class="modal-header">
            <button class="close" data-dismiss="modal">Ã—</button>
            <h3>Delete your CloudTeams Account</h3>
        </div>
        <div class="modal-body">
            <p>If you delete your CloudTeams account, all of your data such as profile information, project preferences
                and external activities will be deleted. <em>This action can not be reverted.</em></p>
            <p>Please note that content you have provided to teams such as customer ideas you may have posted or
                questionnaires you have responded can not be withdrawn.</p>
            <p>Type <b>DELETE</b> in the box below and click the OK button to delete your account:</p>

            <form class="delete-account-form" action="/activitytracker/account/delete/" method="POST">
                {% csrf_token %}

                <input type="text" name="delete_confirm" id="id_delete_confirm" value="" required="required" placeholder="Type DELETE to condirm"/>
                <button type="submit" class="btn btn-transparent pull-right" style="margin: 20px 0"><i class="fa fa-trash-o"></i> <span>OK</span></button>
            </form>

        </div>
    </div>
{% endblock %}

{% block js %}
    <script src="{% static 'bower_components/datatables/media/js/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'bower_components/datatables/media/js/dataTables.bootstrap.min.js' %}"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/1.0.7/js/dataTables.responsive.min.js"></script>
    <script src="{% static 'bower_components/bootstrap-tokenfield/dist/bootstrap-tokenfield.min.js' %}"></script>
    <script src="{% static 'activitytracker/js/bootstrap-slider.js' %}"></script>
    <script src="{% static 'activitytracker/js/custom.js' %}"></script>
    <script src="{% static 'activitytracker/js/settings.js' %}?v=20170118.1"></script>
    <script src="{% static 'activitytracker/js/delete-account.js' %}"></script>
{% endblock %}
